# SharePoint Standards

## Low Impact

| Standard Name                                                | Description                                                                                                                                                              | PowerShell Equivalent                                                                              | APIName                  | Recommended By |
| ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------- | ------------------------ | -------------- |
| Set deleted user retention time in OneDrive                  | When a OneDrive user gets deleted, the personal SharePoint site is saved for selected time in years and data can be retrieved from it.                                   | Update-MgBetaAdminSharepointSetting                                                                | DeletedUserRentention    |                |
| Enable SharePoint and OneDrive integration with Azure AD B2B | Ensure SharePoint and OneDrive integration with Azure AD B2B is enabled                                                                                                  | Set-SPOTenant -EnableAzureADB2BIntegration \$true                                                  | SPAzureB2B               | "CIS 3.0"      |
| Disable Legacy Workflows                                     | Disables the creation of new SharePoint 2010 and 2013 classic workflows and removes the 'Return to classic SharePoint' link on modern SharePoint list and library pages. | Set-SPOTenant -DisableWorkflow2010 \$true -DisableWorkflow2013 \$true -DisableBackToClassic \$true | SPDisableLegacyWorkflows |                |
| Disallow downloading infected files from SharePoint          | Ensure Office 365 SharePoint infected files are disallowed for download                                                                                                  | Set-SPOTenant -DisallowInfectedFileDownload \$true                                                 | SPDisallowInfectedFiles  | "CIS 3.0"      |
| Set Default Timezone for Tenant                              | Sets the default timezone for the tenant. This will be used for all new users and sites.                                                                                 | Update-MgBetaAdminSharepointSetting                                                                | TenantDefaultTimezone    |                |

## Medium Impact

| Standard Name                                      | Description                                                                                                                                                                                                                                            | PowerShell Equivalent                                                             | APIName                       | Recommended By |
| -------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------- | ----------------------------- | -------------- |
| Disable Add Shortcuts To OneDrive                  | When the feature is disabled the option Add shortcut to OneDrive will be removed. Any folders that have already been added will remain on the user's computer.                                                                                         | Graph API or Portal                                                               | DisableAddShortcutsToOneDrive |                |
| Disable legacy basic authentication for SharePoint | Disables the ability for users and applications to access SharePoint via legacy basic authentication. This will likely not have any user impact, but will block systems/applications depending on basic auth or the SharePointOnlineCredentials class. | Set-SPOTenant -LegacyAuthProtocolsEnabled \$false                                 | DisableSharePointLegacyAuth   | "CIS"          |
| Default sharing to Direct users                    | Ensure default link sharing is set to Direct in SharePoint and OneDrive                                                                                                                                                                                | Set-SPOTenant -DefaultSharingLinkType Direct                                      | SPDirectSharing               | "CIS 3.0"      |
| Require reauthentication with verification code    | Ensure reauthentication with verification code is restricted                                                                                                                                                                                           | Set-SPOTenant -EmailAttestationRequired \$true -EmailAttestationReAuthDays 15     | SPEmailAttestation            | "CIS 3.0"      |
| Set guest access to expire automatically           | Ensure guest access to a site or OneDrive will expire automatically                                                                                                                                                                                    | Set-SPOTenant -ExternalUserExpireInDays 30 -ExternalUserExpirationRequired \$True | SPExternalUserExpiration      | "CIS 3.0"      |

## High Impact

| Standard Name                                             | Description                                                                                                                                                                                                           | PowerShell Equivalent               | APIName                  | Recommended By |
| --------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------- | ------------------------ | -------------- |
| Do not allow Mac devices to sync using OneDrive           | Disables the ability for Mac devices to sync with OneDrive.                                                                                                                                                           | Update-MgAdminSharepointSetting     | disableMacSync           |                |
| Disable Resharing by External Users                       | Disables the ability for external users to share files they don't own. Sharing links can only be made for People with existing access. This is a tenant wide setting and overrules any settings set on the site level | Update-MgBetaAdminSharepointSetting | DisableReshare           | "CIS"          |
| Disable site creation by standard users                   | Disables standard users from creating SharePoint sites, also disables the ability to fully create teams                                                                                                               | Update-MgAdminSharepointSetting     | DisableUserSiteCreate    |                |
| Exclude File Extensions from Syncing                      | Sets the file extensions that are excluded from syncing with OneDrive. These files will be blocked from upload. '\*.' is automatically added to the extension and can be omitted.                                     | Update-MgAdminSharepointSetting     | ExcludedfileExt          |                |
| Set Sharing Level for OneDrive and Sharepoint             | Sets the default sharing level for OneDrive and Sharepoint. This is a tenant wide setting and overrules any settings set on the site level                                                                            | Update-MgBetaAdminSharepointSetting | sharingCapability        | "CIS"          |
| Restrict sharing to a specific domain                     | Restricts sharing to only users with the specified domain. This is useful for organizations that only want to share with their own domain.                                                                            | Update-MgAdminSharepointSetting     | sharingDomainRestriction |                |
| Only allow users to sync OneDrive from AAD joined devices | The unmanaged Sync standard has been temporarily disabled and does nothing.                                                                                                                                           | Update-MgAdminSharepointSetting     | unmanagedSync            |                |
